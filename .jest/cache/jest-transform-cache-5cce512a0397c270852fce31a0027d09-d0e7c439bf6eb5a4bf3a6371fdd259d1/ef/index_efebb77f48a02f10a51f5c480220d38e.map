{"version":3,"sources":["index.js"],"names":["Object","defineProperty","exports","value","createChangeEmitter","currentListeners","nextListeners","ensureCanMutateNextListeners","slice","listen","listener","Error","isSubscribed","push","index","indexOf","splice","emit","listeners","i","length","apply","arguments"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;;AAGA,IAAIC,mBAAmB,GAAGF,OAAO,CAACE,mBAAR,GAA8B,SAASA,mBAAT,GAA+B;AACrF,MAAIC,gBAAgB,GAAG,EAAvB;AACA,MAAIC,aAAa,GAAGD,gBAApB;;AAEA,WAASE,4BAAT,GAAwC;AACtC,QAAID,aAAa,KAAKD,gBAAtB,EAAwC;AACtCC,MAAAA,aAAa,GAAGD,gBAAgB,CAACG,KAAjB,EAAhB;AACD;AACF;;AAED,WAASC,MAAT,CAAgBC,QAAhB,EAA0B;AACxB,QAAI,OAAOA,QAAP,KAAoB,UAAxB,EAAoC;AAClC,YAAM,IAAIC,KAAJ,CAAU,qCAAV,CAAN;AACD;;AAED,QAAIC,YAAY,GAAG,IAAnB;AAEAL,IAAAA,4BAA4B;AAC5BD,IAAAA,aAAa,CAACO,IAAd,CAAmBH,QAAnB;AAEA,WAAO,YAAY;AACjB,UAAI,CAACE,YAAL,EAAmB;AACjB;AACD;;AAEDA,MAAAA,YAAY,GAAG,KAAf;AAEAL,MAAAA,4BAA4B;AAC5B,UAAIO,KAAK,GAAGR,aAAa,CAACS,OAAd,CAAsBL,QAAtB,CAAZ;AACAJ,MAAAA,aAAa,CAACU,MAAd,CAAqBF,KAArB,EAA4B,CAA5B;AACD,KAVD;AAWD;;AAED,WAASG,IAAT,GAAgB;AACdZ,IAAAA,gBAAgB,GAAGC,aAAnB;AACA,QAAIY,SAAS,GAAGb,gBAAhB;;AACA,SAAK,IAAIc,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,SAAS,CAACE,MAA9B,EAAsCD,CAAC,EAAvC,EAA2C;AACzCD,MAAAA,SAAS,CAACC,CAAD,CAAT,CAAaE,KAAb,CAAmBH,SAAnB,EAA8BI,SAA9B;AACD;AACF;;AAED,SAAO;AACLb,IAAAA,MAAM,EAAEA,MADH;AAELQ,IAAAA,IAAI,EAAEA;AAFD,GAAP;AAID,CA7CD","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar createChangeEmitter = exports.createChangeEmitter = function createChangeEmitter() {\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n\n  function listen(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error('Expected listener to be a function.');\n    }\n\n    var isSubscribed = true;\n\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n\n    return function () {\n      if (!isSubscribed) {\n        return;\n      }\n\n      isSubscribed = false;\n\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n    };\n  }\n\n  function emit() {\n    currentListeners = nextListeners;\n    var listeners = currentListeners;\n    for (var i = 0; i < listeners.length; i++) {\n      listeners[i].apply(listeners, arguments);\n    }\n  }\n\n  return {\n    listen: listen,\n    emit: emit\n  };\n};"]}